% Table 3: Type System Constraints and Properties
% Author: OTLP Project
% Date: October 20, 2025

\begin{table}[t]
\centering
\caption{OTLP type system constraints (C1-C5) and verified properties. Type soundness is proven through Progress and Preservation theorems, mechanically verified in Coq (1,500 lines) and Isabelle/HOL (640 lines). All constraints are statically checkable at compile-time or runtime, enabling early error detection.}
\label{tab:type-system}
\small
\begin{tabular}{|c|p{4.5cm}|p{2cm}|}
\hline
\textbf{ID} & \textbf{Constraint / Property} & \textbf{Verification} \\
\hline
\hline
\multicolumn{3}{|c|}{\textit{Type Constraints (Static Checking)}} \\
\hline
\textbf{C1} & \textbf{ID Non-Zero}: $\texttt{trace\_id} \neq 0 \land \texttt{span\_id} \neq 0$ & Type Rule \\
\hline
\textbf{C2} & \textbf{Temporal Order}: $\texttt{start\_time} \leq \texttt{end\_time}$ & Type Rule \\
\hline
\textbf{C3} & \textbf{Parent Containment}: $\texttt{parent.start} \leq \texttt{child.start}$ $\land$ $\texttt{child.end} \leq \texttt{parent.end}$ & Type Rule \\
\hline
\textbf{C4} & \textbf{Trace Consistency}: $\forall s \in \texttt{trace}.$ $s.\texttt{trace\_id} = \texttt{trace}.\texttt{id}$ & Type Rule \\
\hline
\textbf{C5} & \textbf{DAG Structure}: $\neg\exists$ cycle in parent-child graph & Control Flow \\
\hline
\hline
\multicolumn{3}{|c|}{\textit{Type Soundness (Theorem 1)}} \\
\hline
\multicolumn{2}{|l|}{\textbf{Progress}: Well-typed states can reduce or are final} & Coq Proof \\
\multicolumn{2}{|l|}{\textbf{Preservation}: Reduction preserves types} & Coq Proof \\
\hline
\hline
\multicolumn{3}{|c|}{\textit{Semantic Correctness Properties}} \\
\hline
\textbf{P1} & \textbf{Trace ID Consistency}: All spans in a trace share the same trace ID & Corollary \\
\hline
\textbf{P2} & \textbf{Temporal Consistency}: Parent spans temporally contain child spans & Property 2 \\
\hline
\textbf{P3} & \textbf{Context Propagation}: Context propagates correctly across boundaries & Property 3 \\
\hline
\textbf{P4} & \textbf{DAG Structure}: Parent-child forms a DAG (no cycles) & Property 4 \\
\hline
\textbf{P5} & \textbf{Export Safety}: Only valid traces can be exported & Property 5 \\
\hline
\end{tabular}

\vspace{0.2cm}

\textbf{Mechanical Verification:}
\begin{itemize}[leftmargin=*, noitemsep, topsep=2pt]
    \item \textbf{Coq}: 1,500 lines proving Progress, Preservation, and all properties
    \item \textbf{Isabelle/HOL}: 640 lines with alternative proof strategies
    \item \textbf{Verification Status}: All theorems and properties formally proven \checkmark
\end{itemize}
\end{table}

