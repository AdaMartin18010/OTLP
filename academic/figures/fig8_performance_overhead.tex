% Figure 8: Performance Overhead vs Batch Size
% Purpose: Show verification overhead scales linearly with batch size
% Location: Section 5.3 (Performance)
% Size: Single column width

\begin{figure}[t]
\centering
\begin{tikzpicture}
\begin{axis}[
    width=0.48\textwidth,
    height=5.5cm,
    xlabel={Batch Size (spans)},
    ylabel={Verification Time (ms)},
    xlabel style={font=\small},
    ylabel style={font=\small},
    xmin=0, xmax=1100,
    ymin=0, ymax=50,
    xtick={0, 200, 400, 600, 800, 1000},
    ytick={0, 10, 20, 30, 40, 50},
    xticklabel style={font=\footnotesize},
    yticklabel style={font=\footnotesize},
    ymajorgrids=true,
    xmajorgrids=true,
    grid style={dashed, gray!30},
    legend style={
        at={(0.5,-0.22)},
        anchor=north,
        legend columns=2,
        font=\tiny
    },
    mark size=2pt,
]

% Average verification time (linear trend)
\addplot[
    color=blue,
    mark=*,
    thick,
    smooth,
] coordinates {
    (10, 0.4)
    (50, 1.8)
    (100, 3.7)
    (200, 7.3)
    (400, 14.8)
    (600, 22.1)
    (800, 29.6)
    (1000, 37.2)
};

% P95 verification time
\addplot[
    color=red,
    mark=triangle*,
    thick,
    smooth,
    dashed,
] coordinates {
    (10, 0.6)
    (50, 2.5)
    (100, 6.5)
    (200, 11.2)
    (400, 23.5)
    (600, 35.2)
    (800, 47.1)
    (1000, 58.8)
};

% Baseline (no verification)
\addplot[
    color=gray,
    mark=none,
    thick,
    dotted,
] coordinates {
    (0, 0.1)
    (1000, 1.2)
};

\legend{Average, P95, Baseline (no verification)}

% Add annotation for acceptable overhead
\node[font=\tiny, text=blue, align=center] at (axis cs:500, 45) {Linear scaling:\\$O(n)$ per span};

% Add target overhead line (5ms per 100 spans)
\draw[thick, green!60!black, dashed] (axis cs:0, 0) -- (axis cs:1000, 50);
\node[font=\tiny, text=green!60!black, rotate=25] at (axis cs:700, 36) {Target (0.05ms/span)};

\end{axis}
\end{tikzpicture}
\caption{Verification Overhead vs Batch Size. The figure demonstrates that our framework's overhead scales linearly with batch size, averaging 3.7ms per 100 spans (0.037ms per span). The P95 latency remains under 6.5ms for typical batch sizes ($\leq$100 spans). The gray dotted line shows baseline processing time without verification. The green dashed line indicates our target overhead (0.05ms per span), which we achieve for batches up to 800 spans.}
\label{fig:performance-overhead}
\end{figure}

