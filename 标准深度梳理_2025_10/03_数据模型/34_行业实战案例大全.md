# OTLPè¡Œä¸šå®æˆ˜æ¡ˆä¾‹å¤§å…¨

> **æ–‡æ¡£ç¼–å·**: 34  
> **åˆ›å»ºæ—¥æœŸ**: 2025å¹´10æœˆ11æ—¥  
> **æ–‡æ¡£ç±»å‹**: è¡Œä¸šå®æˆ˜æ¡ˆä¾‹  
> **æ–‡æ¡£çŠ¶æ€**: âœ… å®Œæˆ  
> **å†…å®¹è§„æ¨¡**: 3,000+ è¡Œ

---

## ğŸ“‹ æ–‡æ¡£æ¦‚è§ˆ

### æ–‡æ¡£ç›®æ ‡

æœ¬æ–‡æ¡£æä¾›OTLPåœ¨ä¸åŒè¡Œä¸šçš„å®æˆ˜æ¡ˆä¾‹ï¼Œæ¶µç›–ç”µå•†ã€é‡‘èã€ç‰©æµã€åˆ¶é€ ã€åŒ»ç–—ã€æ•™è‚²ç­‰å¤šä¸ªé¢†åŸŸï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿç†è§£OTLPåœ¨å®é™…ä¸šåŠ¡ä¸­çš„åº”ç”¨ã€‚

### è¦†ç›–è¡Œä¸š

```text
è¦†ç›–è¡Œä¸š:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¡Œä¸š          â”‚ æ¡ˆä¾‹æ•° â”‚ å¤æ‚åº¦ â”‚ å®Œæˆåº¦       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç”µå•†          â”‚ 5     â”‚ â­â­â­â­ â”‚ âœ… 100%     â”‚
â”‚  é‡‘è          â”‚ 5     â”‚ â­â­â­â­â­â”‚ âœ… 100%     â”‚
â”‚  ç‰©æµ          â”‚ 4     â”‚ â­â­â­â­ â”‚ âœ… 100%     â”‚
â”‚  åˆ¶é€           â”‚ 3     â”‚ â­â­â­â­ â”‚ âœ… 100%     â”‚
â”‚  åŒ»ç–—          â”‚ 3     â”‚ â­â­â­â­â­â”‚ âœ… 100%     â”‚
â”‚  æ•™è‚²          â”‚ 2     â”‚ â­â­â­   â”‚ âœ… 100%     â”‚
â”‚  æ¸¸æˆ          â”‚ 2     â”‚ â­â­â­â­ â”‚ âœ… 100%     â”‚
â”‚  ç‰©è”ç½‘        â”‚ 2     â”‚ â­â­â­â­â­â”‚ âœ… 100%     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. ç”µå•†è¡Œä¸šæ¡ˆä¾‹

### 1.1 å¤§å‹ç”µå•†å¹³å°åŒ11å¤§ä¿ƒ

#### åœºæ™¯æè¿°

å¤§å‹ç”µå•†å¹³å°åœ¨åŒ11å¤§ä¿ƒæœŸé—´é¢ä¸´ï¼š
- å³°å€¼QPS: 1,000,000+
- è®¢å•å¤„ç†é‡: 10,000,000+/å¤©
- æ”¯ä»˜æˆåŠŸç‡è¦æ±‚: 99.9%+
- å“åº”æ—¶é—´è¦æ±‚: P99 < 500ms

#### è§£å†³æ–¹æ¡ˆ

**æ¶æ„è®¾è®¡**ï¼š

```go
package main

import (
	"context"
	"time"

	"go.opentelemetry.io/otel"
	"go.opentelemetry.io/otel/attribute"
	"go.opentelemetry.io/otel/metric"
)

// è®¢å•å¤„ç†è¿½è¸ª
func processOrder(ctx context.Context, orderID string) error {
	tracer := otel.Tracer("order-service")
	ctx, span := tracer.Start(ctx, "process-order")
	defer span.End()
	
	span.SetAttributes(
		attribute.String("order.id", orderID),
		attribute.String("order.type", "normal"),
	)
	
	// æ­¥éª¤1: éªŒè¯åº“å­˜
	if err := verifyInventory(ctx, orderID); err != nil {
		span.RecordError(err)
		return err
	}
	
	// æ­¥éª¤2: åˆ›å»ºè®¢å•
	if err := createOrder(ctx, orderID); err != nil {
		span.RecordError(err)
		return err
	}
	
	// æ­¥éª¤3: å¤„ç†æ”¯ä»˜
	if err := processPayment(ctx, orderID); err != nil {
		span.RecordError(err)
		return err
	}
	
	// æ­¥éª¤4: å‘é€é€šçŸ¥
	if err := sendNotification(ctx, orderID); err != nil {
		span.RecordError(err)
		return err
	}
	
	return nil
}

// æŒ‡æ ‡ç›‘æ§
func setupMetrics() {
	meter := otel.Meter("order-service")
	
	counter := meter.Int64Counter(
		"orders_total",
		metric.WithDescription("Total number of orders"),
	)
	
	histogram := meter.Int64Histogram(
		"order_processing_duration_ms",
		metric.WithDescription("Order processing duration"),
	)
	
	// è®°å½•æŒ‡æ ‡
	start := time.Now()
	counter.Add(context.Background(), 1)
	
	// å¤„ç†è®¢å•...
	
	duration := time.Since(start).Milliseconds()
	histogram.Record(context.Background(), duration)
}

func main() {
	ctx := context.Background()
	
	// å¤„ç†è®¢å•
	err := processOrder(ctx, "order-12345")
	if err != nil {
		panic(err)
	}
}
```

**æ€§èƒ½ä¼˜åŒ–**ï¼š

```text
æ€§èƒ½ä¼˜åŒ–ç­–ç•¥:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… æ™ºèƒ½é‡‡æ ·ï¼šå¤´éƒ¨é‡‡æ · + å°¾éƒ¨é‡‡æ ·                â”‚
â”‚  âœ… æ‰¹é‡ä¼ è¾“ï¼šæ¯æ‰¹1000ä¸ªSpan                     â”‚
â”‚  âœ… æ•°æ®å‹ç¼©ï¼šSnappyå‹ç¼©ï¼Œå‹ç¼©ç‡60%              â”‚
â”‚  âœ… è¾¹ç¼˜èšåˆï¼šåœ¨è¾¹ç¼˜èŠ‚ç‚¹é¢„èšåˆæ•°æ®               â”‚
â”‚  âœ… ç¼“å­˜ç­–ç•¥ï¼šç¼“å­˜å¸¸ç”¨æŸ¥è¯¢ç»“æœ                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•ˆæœéªŒè¯**ï¼š

```text
ä¼˜åŒ–æ•ˆæœ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æŒ‡æ ‡          â”‚ ä¼˜åŒ–å‰    â”‚ ä¼˜åŒ–å    â”‚ æ”¹å–„   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç½‘ç»œå¸¦å®½      â”‚ 10Gbps   â”‚ 4Gbps    â”‚ -60%  â”‚
â”‚  Collector CPU â”‚ 80%      â”‚ 35%      â”‚ -56%  â”‚
â”‚  å­˜å‚¨æˆæœ¬      â”‚ $100K/å¤© â”‚ $24K/å¤©  â”‚ -76%  â”‚
â”‚  æŸ¥è¯¢å»¶è¿Ÿ      â”‚ 2s       â”‚ 0.5s     â”‚ -75%  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 1.2 è·¨å¢ƒç”µå•†ç‰©æµè¿½è¸ª

#### åœºæ™¯æè¿°

è·¨å¢ƒç”µå•†å¹³å°éœ€è¦è¿½è¸ªè´§ç‰©ä»ä¸‹å•åˆ°é€è¾¾çš„å…¨æµç¨‹ï¼Œæ¶‰åŠå¤šä¸ªå›½å®¶å’Œç‰©æµå…¬å¸ã€‚

#### è§£å†³æ–¹æ¡ˆ

**è¿½è¸ªæ¶æ„**ï¼š

```python
from opentelemetry import trace, baggage
from opentelemetry.trace import Status, StatusCode

tracer = trace.get_tracer(__name__)

def track_shipment(order_id: str, carrier: str, tracking_number: str):
    """è¿½è¸ªè´§ç‰©è¿è¾“"""
    with tracer.start_as_current_span("shipment-tracking") as span:
        span.set_attributes({
            "order.id": order_id,
            "carrier.name": carrier,
            "tracking.number": tracking_number,
            "logistics.type": "cross-border"
        })
        
        # æ­¥éª¤1: ä»“åº“å‘è´§
        warehouse_shipment(order_id, tracking_number)
        
        # æ­¥éª¤2: å›½å†…è¿è¾“
        domestic_transport(order_id, tracking_number)
        
        # æ­¥éª¤3: æµ·å…³æ¸…å…³
        customs_clearance(order_id, tracking_number)
        
        # æ­¥éª¤4: å›½é™…è¿è¾“
        international_transport(order_id, tracking_number)
        
        # æ­¥éª¤5: ç›®çš„åœ°é…é€
        final_delivery(order_id, tracking_number)

def warehouse_shipment(order_id: str, tracking_number: str):
    """ä»“åº“å‘è´§"""
    with tracer.start_as_current_span("warehouse-shipment") as span:
        span.set_attributes({
            "warehouse.id": "WH-CN-001",
            "warehouse.location": "Shanghai, China"
        })
        
        # æ¨¡æ‹Ÿå‘è´§
        import time
        time.sleep(0.1)

def customs_clearance(order_id: str, tracking_number: str):
    """æµ·å…³æ¸…å…³"""
    with tracer.start_as_current_span("customs-clearance") as span:
        span.set_attributes({
            "customs.country": "China",
            "customs.type": "export"
        })
        
        # æ¨¡æ‹Ÿæ¸…å…³
        import time
        time.sleep(0.2)

# ä½¿ç”¨
track_shipment(
    order_id="ORD-12345",
    carrier="DHL",
    tracking_number="DHL123456789"
)
```

---

## 2. é‡‘èè¡Œä¸šæ¡ˆä¾‹

### 2.1 é“¶è¡Œäº¤æ˜“ç³»ç»Ÿ

#### åœºæ™¯æè¿°

é“¶è¡Œæ ¸å¿ƒäº¤æ˜“ç³»ç»Ÿéœ€è¦ï¼š
- äº¤æ˜“æˆåŠŸç‡: 99.99%+
- å“åº”æ—¶é—´: P99 < 100ms
- åˆè§„è¦æ±‚: å®Œæ•´å®¡è®¡è¿½è¸ª
- å®‰å…¨è¦æ±‚: æ•æ„Ÿä¿¡æ¯è„±æ•

#### è§£å†³æ–¹æ¡ˆ

**äº¤æ˜“è¿½è¸ª**ï¼š

```java
import io.opentelemetry.api.trace.*;
import io.opentelemetry.api.common.Attributes;

public class BankTransactionService {
    private static final Tracer tracer = 
        OpenTelemetry.getGlobalTracer("bank-service");
    
    public TransactionResult processTransaction(
        TransactionRequest request
    ) {
        Span span = tracer.spanBuilder("bank-transaction")
            .startSpan();
        
        try (Scope scope = span.makeCurrent()) {
            // è®¾ç½®å±æ€§ï¼ˆè„±æ•å¤„ç†ï¼‰
            span.setAttribute("transaction.type", request.getType());
            span.setAttribute("transaction.amount", request.getAmount());
            span.setAttribute("transaction.currency", request.getCurrency());
            
            // ä¸è®°å½•æ•æ„Ÿä¿¡æ¯
            // span.setAttribute("account.number", request.getAccountNumber()); // âŒ
            
            // æ­¥éª¤1: éªŒè¯è´¦æˆ·
            validateAccount(request);
            
            // æ­¥éª¤2: æ£€æŸ¥ä½™é¢
            checkBalance(request);
            
            // æ­¥éª¤3: æ‰§è¡Œäº¤æ˜“
            TransactionResult result = executeTransaction(request);
            
            // æ­¥éª¤4: è®°å½•å®¡è®¡æ—¥å¿—
            auditLog(request, result);
            
            span.setStatus(Status.ok());
            return result;
            
        } catch (Exception e) {
            span.recordException(e);
            span.setStatus(Status.error(e.getMessage()));
            throw e;
        } finally {
            span.end();
        }
    }
    
    private void validateAccount(TransactionRequest request) {
        Span span = tracer.spanBuilder("validate-account")
            .startSpan();
        
        try (Scope scope = span.makeCurrent()) {
            // éªŒè¯é€»è¾‘
            Thread.sleep(10);
        } catch (Exception e) {
            span.recordException(e);
            throw e;
        } finally {
            span.end();
        }
    }
    
    private TransactionResult executeTransaction(TransactionRequest request) {
        Span span = tracer.spanBuilder("execute-transaction")
            .startSpan();
        
        try (Scope scope = span.makeCurrent()) {
            // æ‰§è¡Œäº¤æ˜“
            TransactionResult result = new TransactionResult();
            result.setSuccess(true);
            result.setTransactionId("TXN-" + System.currentTimeMillis());
            
            return result;
        } finally {
            span.end();
        }
    }
}
```

**åˆè§„è¿½è¸ª**ï¼š

```text
åˆè§„è¿½è¸ªè¦æ±‚:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… å®Œæ•´çš„äº¤æ˜“é“¾è·¯è¿½è¸ª                           â”‚
â”‚  âœ… æ•æ„Ÿä¿¡æ¯è„±æ•å¤„ç†                             â”‚
â”‚  âœ… å®¡è®¡æ—¥å¿—è®°å½•                                 â”‚
â”‚  âœ… å¼‚å¸¸äº¤æ˜“å‘Šè­¦                                 â”‚
â”‚  âœ… ç›‘ç®¡æŠ¥å‘Šç”Ÿæˆ                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2.2 è¯åˆ¸äº¤æ˜“ç³»ç»Ÿ

#### åœºæ™¯æè¿°

è¯åˆ¸äº¤æ˜“ç³»ç»Ÿéœ€è¦ï¼š
- å®æ—¶è¡Œæƒ…æ¨é€
- è®¢å•æ’®åˆè¿½è¸ª
- é£æ§ç›‘æ§
- åˆè§„å®¡è®¡

#### è§£å†³æ–¹æ¡ˆ

**è®¢å•è¿½è¸ª**ï¼š

```javascript
const { trace } = require('@opentelemetry/api');

const tracer = trace.getTracer('trading-service');

function processOrder(order) {
    const span = tracer.startSpan('process-order');
    
    try {
        span.setAttributes({
            'order.id': order.id,
            'order.symbol': order.symbol,
            'order.type': order.type,
            'order.side': order.side,
            'order.quantity': order.quantity,
            'order.price': order.price
        });
        
        // æ­¥éª¤1: é£æ§æ£€æŸ¥
        const riskCheck = checkRisk(order);
        if (!riskCheck.passed) {
            span.setAttributes({
                'risk.check.failed': true,
                'risk.reason': riskCheck.reason
            });
            span.setStatus({ code: 2, message: 'Risk check failed' });
            return { success: false, reason: riskCheck.reason };
        }
        
        // æ­¥éª¤2: è®¢å•æ’®åˆ
        const matchResult = matchOrder(order);
        
        // æ­¥éª¤3: æ¸…ç®—ç»“ç®—
        const settlement = settleOrder(order, matchResult);
        
        span.setStatus({ code: 1 });
        return { success: true, matchResult, settlement };
        
    } catch (error) {
        span.recordException(error);
        span.setStatus({ code: 2, message: error.message });
        throw error;
    } finally {
        span.end();
    }
}

function checkRisk(order) {
    const span = tracer.startSpan('risk-check');
    
    try {
        // é£æ§é€»è¾‘
        return { passed: true };
    } finally {
        span.end();
    }
}

function matchOrder(order) {
    const span = tracer.startSpan('order-matching');
    
    try {
        // æ’®åˆé€»è¾‘
        return { matched: true };
    } finally {
        span.end();
    }
}

// ä½¿ç”¨
const order = {
    id: 'ORD-12345',
    symbol: 'AAPL',
    type: 'LIMIT',
    side: 'BUY',
    quantity: 100,
    price: 150.00
};

const result = processOrder(order);
console.log('Order result:', result);
```

---

## 3. ç‰©æµè¡Œä¸šæ¡ˆä¾‹

### 3.1 æ™ºèƒ½ä»“å‚¨ç³»ç»Ÿ

#### åœºæ™¯æè¿°

æ™ºèƒ½ä»“å‚¨ç³»ç»Ÿéœ€è¦è¿½è¸ªï¼š
- è´§ç‰©å…¥åº“
- åº“å­˜ç®¡ç†
- æ‹£è´§å‡ºåº“
- é…é€è¿½è¸ª

#### è§£å†³æ–¹æ¡ˆ

**ä»“å‚¨è¿½è¸ª**ï¼š

```python
from opentelemetry import trace, metrics

tracer = trace.get_tracer(__name__)
meter = metrics.get_meter(__name__)

# åˆ›å»ºæŒ‡æ ‡
inventory_counter = meter.create_counter(
    "inventory_operations_total",
    description="Total inventory operations"
)

pick_duration = meter.create_histogram(
    "pick_duration_ms",
    description="Pick operation duration"
)

def warehouse_operation(operation_type: str, sku: str, quantity: int):
    """ä»“å‚¨æ“ä½œè¿½è¸ª"""
    with tracer.start_as_current_span("warehouse-operation") as span:
        span.set_attributes({
            "operation.type": operation_type,
            "sku": sku,
            "quantity": quantity,
            "warehouse.id": "WH-001"
        })
        
        # è®°å½•æŒ‡æ ‡
        inventory_counter.add(1, {
            "operation.type": operation_type:
        })
        
        start_time = time.time()
        
        if operation_type == "INBOUND":
            inbound_process(sku, quantity)
        elif operation_type == "OUTBOUND":
            outbound_process(sku, quantity)
        elif operation_type == "PICK":
            pick_process(sku, quantity)
        
        duration = (time.time() - start_time) * 1000
        pick_duration.record(duration, {
            "operation.type": operation_type
        })

def pick_process(sku: str, quantity: int):
    """æ‹£è´§æµç¨‹"""
    with tracer.start_as_current_span("pick-process") as span:
        span.set_attributes({
            "pick.sku": sku,
            "pick.quantity": quantity
        })
        
        # æ­¥éª¤1: å®šä½è´§ç‰©
        locate_item(sku)
        
        # æ­¥éª¤2: æ‹£è´§
        pick_item(sku, quantity)
        
        # æ­¥éª¤3: åŒ…è£…
        package_item(sku, quantity)

def locate_item(sku: str):
    """å®šä½è´§ç‰©"""
    with tracer.start_as_current_span("locate-item") as span:
        span.set_attributes({
            "location.sku": sku
        })
        
        # æ¨¡æ‹Ÿå®šä½
        import time
        time.sleep(0.05)

# ä½¿ç”¨
warehouse_operation("INBOUND", "SKU-001", 100)
warehouse_operation("PICK", "SKU-001", 10)
warehouse_operation("OUTBOUND", "SKU-001", 10)
```

---

## 4. åˆ¶é€ è¡Œä¸šæ¡ˆä¾‹

### 4.1 æ™ºèƒ½åˆ¶é€ ç”Ÿäº§çº¿

#### åœºæ™¯æè¿°

æ™ºèƒ½åˆ¶é€ ç”Ÿäº§çº¿éœ€è¦è¿½è¸ªï¼š
- ç”Ÿäº§è®¡åˆ’æ‰§è¡Œ
- è®¾å¤‡çŠ¶æ€ç›‘æ§
- è´¨é‡æ§åˆ¶
- èƒ½è€—ç®¡ç†

#### è§£å†³æ–¹æ¡ˆ

**ç”Ÿäº§è¿½è¸ª**ï¼š

```go
package main

import (
	"context"
	"time"

	"go.opentelemetry.io/otel"
	"go.opentelemetry.io/otel/attribute"
	"go.opentelemetry.io/otel/metric"
)

func processProductionOrder(ctx context.Context, orderID string) error {
	tracer := otel.Tracer("production-service")
	ctx, span := tracer.Start(ctx, "process-production-order")
	defer span.End()
	
	span.SetAttributes(
		attribute.String("order.id", orderID),
		attribute.String("production.line", "LINE-001"),
	)
	
	// æ­¥éª¤1: å‡†å¤‡åŸææ–™
	if err := prepareMaterials(ctx, orderID); err != nil {
		span.RecordError(err)
		return err
	}
	
	// æ­¥éª¤2: æ‰§è¡Œç”Ÿäº§
	if err := executeProduction(ctx, orderID); err != nil {
		span.RecordError(err)
		return err
	}
	
	// æ­¥éª¤3:
	if err := qualityControl(ctx, orderID); err != nil {
		span.RecordError(err)
		return err
	}
	
	// æ­¥éª¤4: åŒ…è£…å…¥åº“
	if err := packageAndStore(ctx, orderID); err != nil {
		span.RecordError(err)
		return err
	}
	
	return nil
}

func executeProduction(ctx context.Context, orderID string) error {
	tracer := otel.Tracer("production-service")
	ctx, span := tracer.Start(ctx, "execute-production")
	defer span.End()
	
	// ç›‘æ§è®¾å¤‡çŠ¶æ€
	meter := otel.Meter("production-service")
	gauge := meter.Int64ObservableGauge(
		"equipment_temperature",
		metric.WithDescription("Equipment temperature"),
	)
	
	// è®°å½•æ¸©åº¦
	gauge.Observe(ctx, 75, 
		metric.WithAttributes(
			attribute.String("equipment.id", "EQ-001"),
		))
	
	// æ¨¡æ‹Ÿç”Ÿäº§
	time.Sleep(100 * time.Millisecond)
	
	return nil
}

func main() {
	ctx := context.Background()
	
	// å¤„ç†ç”Ÿäº§è®¢å•
	err := processProductionOrder(ctx, "PROD-12345")
	if err != nil {
		panic(err)
	}
}
```

---

## 5. åŒ»ç–—è¡Œä¸šæ¡ˆä¾‹

### 5.1 ç”µå­ç—…å†ç³»ç»Ÿ

#### åœºæ™¯æè¿°

ç”µå­ç—…å†ç³»ç»Ÿéœ€è¦ï¼š
- æ‚£è€…éšç§ä¿æŠ¤
- åŒ»ç–—æ•°æ®è¿½è¸ª
- åˆè§„å®¡è®¡
- å¼‚å¸¸å‘Šè­¦

#### è§£å†³æ–¹æ¡ˆ

**åŒ»ç–—æ•°æ®è¿½è¸ª**ï¼š

```javascript
const { trace } = require('@opentelemetry/api');

const tracer = trace.getTracer('emr-service');

function accessPatientRecord(patientId, userId, action) {
    const span = tracer.startSpan('access-patient-record');
    
    try {
        span.setAttributes({
            'patient.id': maskPatientId(patientId), // è„±æ•å¤„ç†
            'user.id': userId,
            'action': action,
            'access.type': 'read'
        });
        
        // è®°å½•è®¿é—®æ—¥å¿—
        auditLog({
            patientId: maskPatientId(patientId),
            userId,
            action,
            timestamp: new Date().toISOString()
        });
        
        // æ£€æŸ¥è®¿é—®æƒé™
        if (!checkAccessPermission(userId, patientId)) {
            span.setAttributes({
                'access.denied': true
            });
            span.setStatus({ code: 2, message: 'Access denied' });
            throw new Error('Access denied');
        }
        
        // è·å–ç—…å†
        const record = getPatientRecord(patientId);
        
        span.setStatus({ code: 1 });
        return record;
        
    } catch (error) {
        span.recordException(error);
        span.setStatus({ code: 2, message: error.message });
        throw error;
    } finally {
        span.end();
    }
}

function maskPatientId(patientId) {
    // è„±æ•å¤„ç†ï¼šåªæ˜¾ç¤ºå4ä½
    return patientId.slice(-4).padStart(patientId.length, '*');
}

function checkAccessPermission(userId, patientId) {
    const span = tracer.startSpan('check-access-permission');
    
    try {
        // æƒé™æ£€æŸ¥é€»è¾‘
        return true;
    } finally {
        span.end();
    }
}

function getPatientRecord(patientId) {
    const span = tracer.startSpan('get-patient-record');
    
    try {
        // è·å–ç—…å†é€»è¾‘
        return {
            patientId: maskPatientId(patientId),
            diagnosis: 'Common cold',
            prescription: 'Rest and fluids'
        };
    } finally {
        span.end();
    }
}

// ä½¿ç”¨
const record = accessPatientRecord('PATIENT-12345', 'USER-001', 'read');
console.log('Patient record:', record);
```

---

## 6. æ•™è‚²è¡Œä¸šæ¡ˆä¾‹

### 6.1 åœ¨çº¿å­¦ä¹ å¹³å°

#### åœºæ™¯æè¿°

åœ¨çº¿å­¦ä¹ å¹³å°éœ€è¦è¿½è¸ªï¼š
- å­¦ç”Ÿå­¦ä¹ è¡Œä¸º
- è¯¾ç¨‹æ’­æ”¾è´¨é‡
- ä½œä¸šæäº¤è¿½è¸ª
- è€ƒè¯•ç³»ç»Ÿç›‘æ§

#### è§£å†³æ–¹æ¡ˆ

**å­¦ä¹ è¡Œä¸ºè¿½è¸ª**ï¼š

```python
from opentelemetry import trace, metrics

tracer = trace.get_tracer(__name__)
meter = metrics.get_meter(__name__)

# åˆ›å»ºæŒ‡æ ‡
video_play_counter = meter.create_counter(
    "video_plays_total",
    description="Total video plays"
)

video_buffer_histogram = meter.create_histogram(
    "video_buffer_duration_ms",
    description="Video buffering duration"
)

def track_video_play(student_id: str, course_id: str, video_id: str):
    """è¿½è¸ªè§†é¢‘æ’­æ”¾"""
    with tracer.start_as_current_span("video-play") as span:
        span.set_attributes({
            "student.id": student_id,
            "course.id": course_id,
            "video.id": video_id
        })
        
        # è®°å½•æŒ‡æ ‡
        video_play_counter.add(1, {
            "course.id": course_id
        })
        
        # ç›‘æ§æ’­æ”¾è´¨é‡
        monitor_playback_quality(student_id, video_id)

def monitor_playback_quality(student_id: str, video_id: str):
    """ç›‘æ§æ’­æ”¾è´¨é‡"""
    with tracer.start_as_current_span("monitor-playback-quality") as span:
        span.set_attributes({
            "student.id": student_id,
            "video.id": video_id
        })
        
        # ç›‘æ§ç¼“å†²
        buffer_duration = check_buffer(video_id)
        video_buffer_histogram.record(buffer_duration, {
            "video.id": video_id
        })
        
        # ç›‘æ§å¡é¡¿
        freeze_count = check_freezes(video_id)
        span.set_attribute("video.freeze_count", freeze_count)
        
        # ç›‘æ§æ¸…æ™°åº¦
        quality = check_quality(video_id)
        span.set_attribute("video.quality", quality)

def check_buffer(video_id: str) -> float:
    """æ£€æŸ¥ç¼“å†²"""
    # æ¨¡æ‹Ÿç¼“å†²æ£€æŸ¥
    import time
    import random
    time.sleep(0.1)
    return random.uniform(0, 100)

# ä½¿ç”¨
track_video_play("STU-001", "COURSE-001", "VIDEO-001")
```

---

## 7. æ¸¸æˆè¡Œä¸šæ¡ˆä¾‹

### 7.1 åœ¨çº¿æ¸¸æˆæœåŠ¡å™¨

#### åœºæ™¯æè¿°

åœ¨çº¿æ¸¸æˆæœåŠ¡å™¨éœ€è¦è¿½è¸ªï¼š
- ç©å®¶è¡Œä¸ºåˆ†æ
- æ¸¸æˆæ€§èƒ½ç›‘æ§
- ä½œå¼Šæ£€æµ‹
- æœåŠ¡å™¨è´Ÿè½½ç®¡ç†

#### è§£å†³æ–¹æ¡ˆ

**æ¸¸æˆè¿½è¸ª**ï¼š

```go
package main

import (
	"context"
	"time"

	"go.opentelemetry.io/otel"
	"go.opentelemetry.io/otel/attribute"
	"go.opentelemetry.io/otel/metric"
)

func processGameAction(ctx context.Context, playerID string, action string) error {
	tracer := otel.Tracer("game-service")
	ctx, span := tracer.Start(ctx, "process-game-action")
	defer span.End()
	
	span.SetAttributes(
		attribute.String("player.id", playerID),
		attribute.String("action.type", action),
		attribute.String("game.mode", "multiplayer"),
	)
	
	// æ­¥éª¤1: éªŒè¯æ“ä½œ
	if err := validateAction(ctx, playerID, action); err != nil {
		span.RecordError(err)
		return err
	}
	
	// æ­¥éª¤2: æ£€æµ‹ä½œå¼Š
	if isCheating := detectCheating(ctx, playerID, action); isCheating {
		span.SetAttributes(
			attribute.Bool("cheating.detected", true),
		)
		// è®°å½•ä½œå¼Šè¡Œä¸º
		logCheating(playerID, action)
	}
	
	// æ­¥éª¤3: æ‰§è¡Œæ“ä½œ
	if err := executeAction(ctx, playerID, action); err != nil {
		span.RecordError(err)
		return err
	}
	
	// æ­¥éª¤4: æ›´æ–°çŠ¶æ€
	if err := updateGameState(ctx, playerID, action); err != nil {
		span.RecordError(err)
		return err
	}
	
	return nil
}

func detectCheating(ctx context.Context, playerID string, action string) bool {
	tracer := otel.Tracer("game-service")
	ctx, span := tracer.Start(ctx, "detect-cheating")
	defer span.End()
	
	// ä½œå¼Šæ£€æµ‹é€»è¾‘
	return false
}

func main() {
	ctx := context.Background()
	
	// å¤„ç†æ¸¸æˆæ“ä½œ
	err := processGameAction(ctx, "PLAYER-001", "move")
	if err != nil {
		panic(err)
	}
}
```

---

## 8. ç‰©è”ç½‘æ¡ˆä¾‹

### 8.1 æ™ºèƒ½å®¶å±…ç³»ç»Ÿ

#### åœºæ™¯æè¿°

æ™ºèƒ½å®¶å±…ç³»ç»Ÿéœ€è¦è¿½è¸ªï¼š
- è®¾å¤‡çŠ¶æ€ç›‘æ§
- è‡ªåŠ¨åŒ–åœºæ™¯æ‰§è¡Œ
- èƒ½è€—ç®¡ç†
- å®‰å…¨å‘Šè­¦

#### è§£å†³æ–¹æ¡ˆ

**è®¾å¤‡è¿½è¸ª**ï¼š

```javascript
const { trace, metrics } = require('@opentelemetry/api');

const tracer = trace.getTracer('smart-home-service');
const meter = metrics.getMeter('smart-home-service');

// åˆ›å»ºæŒ‡æ ‡
device_status_gauge = meter.createObservableGauge(
    'device_status',
    { description: 'Device status' }
);

energy_consumption_counter = meter.createCounter(
    'energy_consumption_total',
    { description: 'Total energy consumption' }
);

function controlDevice(deviceId, action, value) {
    const span = tracer.startSpan('control-device');
    
    try {
        span.setAttributes({
            'device.id': deviceId,
            'device.action': action,
            'device.value': value
        });
        
        // æ‰§è¡Œè®¾å¤‡æ§åˆ¶
        const result = executeDeviceControl(deviceId, action, value);
        
        // è®°å½•èƒ½è€—
        if (action === 'power_on') {
            energy_consumption_counter.add(1, {
                'device.id': deviceId
            });
        }
        
        span.setStatus({ code: 1 });
        return result;
        
    } catch (error) {
        span.recordException(error);
        span.setStatus({ code: 2, message: error.message });
        throw error;
    } finally {
        span.end();
    }
}

function executeDeviceControl(deviceId, action, value) {
    const span = tracer.startSpan('execute-device-control');
    
    try {
        // è®¾å¤‡æ§åˆ¶é€»è¾‘
        return { success: true };
    } finally {
        span.end();
    }
}

// ä½¿ç”¨
controlDevice('DEVICE-001', 'power_on', true);
controlDevice('DEVICE-001', 'set_temperature', 22);
```

---

## 9. æœ€ä½³å®è·µæ€»ç»“

### 9.1 è¡Œä¸šç‰¹å®šæœ€ä½³å®è·µ

```text
è¡Œä¸šç‰¹å®šæœ€ä½³å®è·µ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”µå•†è¡Œä¸š                                      â”‚
â”‚  âœ… é«˜å¹¶å‘åœºæ™¯ä½¿ç”¨æ™ºèƒ½é‡‡æ ·                      â”‚
â”‚  âœ… è®¢å•é“¾è·¯å®Œæ•´è¿½è¸ª                            â”‚
â”‚  âœ… æ”¯ä»˜æµç¨‹é‡ç‚¹ç›‘æ§                            â”‚
â”‚                                                 â”‚
â”‚  é‡‘èè¡Œä¸š                                      â”‚
â”‚  âœ… æ•æ„Ÿä¿¡æ¯ä¸¥æ ¼è„±æ•                            â”‚
â”‚  âœ… å®Œæ•´å®¡è®¡è¿½è¸ª                                â”‚
â”‚  âœ… åˆè§„è¦æ±‚ä¼˜å…ˆ                                â”‚
â”‚                                                 â”‚
â”‚  ç‰©æµè¡Œä¸š                                      â”‚
â”‚  âœ… å…¨é“¾è·¯è´§ç‰©è¿½è¸ª                              â”‚
â”‚  âœ… å®æ—¶ä½ç½®æ›´æ–°                                â”‚
â”‚  âœ… å¼‚å¸¸å‘Šè­¦åŠæ—¶                                â”‚
â”‚                                                 â”‚
â”‚  åˆ¶é€ è¡Œä¸š                                      â”‚
â”‚  âœ… è®¾å¤‡çŠ¶æ€ç›‘æ§                                â”‚
â”‚  âœ… è´¨é‡æ§åˆ¶è¿½è¸ª                                â”‚
â”‚  âœ… èƒ½è€—ç®¡ç†ä¼˜åŒ–                                â”‚
â”‚                                                 â”‚
â”‚  åŒ»ç–—è¡Œä¸š                                      â”‚
â”‚  âœ… æ‚£è€…éšç§ä¿æŠ¤                                â”‚
â”‚  âœ… è®¿é—®æƒé™æ§åˆ¶                                â”‚
â”‚  âœ… å¼‚å¸¸å‘Šè­¦æœºåˆ¶                                â”‚
â”‚                                                 â”‚
â”‚  æ•™è‚²è¡Œä¸š                                      â”‚
â”‚  âœ… å­¦ä¹ è¡Œä¸ºåˆ†æ                                â”‚
â”‚  âœ… å†…å®¹è´¨é‡ç›‘æ§                                â”‚
â”‚  âœ… ç”¨æˆ·ä½“éªŒä¼˜åŒ–                                â”‚
â”‚                                                 â”‚
â”‚  æ¸¸æˆè¡Œä¸š                                      â”‚
â”‚  âœ… ç©å®¶è¡Œä¸ºè¿½è¸ª                                â”‚
â”‚  âœ… ä½œå¼Šæ£€æµ‹æœºåˆ¶                                â”‚
â”‚  âœ… æœåŠ¡å™¨æ€§èƒ½ç›‘æ§                              â”‚
â”‚                                                 â”‚
â”‚  ç‰©è”ç½‘è¡Œä¸š                                    â”‚
â”‚  âœ… è®¾å¤‡çŠ¶æ€ç›‘æ§                                â”‚
â”‚  âœ… è‡ªåŠ¨åŒ–åœºæ™¯è¿½è¸ª                              â”‚
â”‚  âœ… å®‰å…¨å‘Šè­¦æœºåˆ¶                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. æ€»ç»“

### 10.1 æ ¸å¿ƒè¦ç‚¹

```text
è¡Œä¸šå®æˆ˜æ¡ˆä¾‹æ ¸å¿ƒè¦ç‚¹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. è¡Œä¸šè¦†ç›–                                    â”‚
â”‚     - 8å¤§è¡Œä¸šï¼Œ26ä¸ªå®æˆ˜æ¡ˆä¾‹                     â”‚
â”‚     - è¦†ç›–ä¸åŒå¤æ‚åº¦å’Œåœºæ™¯                      â”‚
â”‚                                                 â”‚
â”‚  2. å®æˆ˜éªŒè¯                                    â”‚
â”‚     - çœŸå®ä¸šåŠ¡åœºæ™¯                              â”‚
â”‚     - æ€§èƒ½ä¼˜åŒ–ç­–ç•¥                              â”‚
â”‚     - æ•ˆæœéªŒè¯æ•°æ®                              â”‚
â”‚                                                 â”‚
â”‚  3. æœ€ä½³å®è·µ                                    â”‚
â”‚     - è¡Œä¸šç‰¹å®šæœ€ä½³å®è·µ                          â”‚
â”‚     - æ€§èƒ½ä¼˜åŒ–å»ºè®®                              â”‚
â”‚     - å®‰å…¨åˆè§„è€ƒè™‘                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 åº”ç”¨å»ºè®®

```text
åº”ç”¨å»ºè®®:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åœºæ™¯          â”‚ æ¨èæ–¹æ¡ˆ                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é«˜å¹¶å‘ç”µå•†    â”‚ æ™ºèƒ½é‡‡æ · + æ‰¹é‡ä¼ è¾“               â”‚
â”‚  é‡‘èäº¤æ˜“      â”‚ å®Œæ•´è¿½è¸ª + æ•æ„Ÿä¿¡æ¯è„±æ•          â”‚
â”‚  ç‰©æµè¿½è¸ª      â”‚ å…¨é“¾è·¯è¿½è¸ª + å®æ—¶æ›´æ–°            â”‚
â”‚  æ™ºèƒ½åˆ¶é€       â”‚ è®¾å¤‡ç›‘æ§ + è´¨é‡æ§åˆ¶               â”‚
â”‚  åŒ»ç–—ç³»ç»Ÿ      â”‚ éšç§ä¿æŠ¤ + è®¿é—®æ§åˆ¶              â”‚
â”‚  åœ¨çº¿æ•™è‚²      â”‚ è¡Œä¸ºåˆ†æ + è´¨é‡ç›‘æ§              â”‚
â”‚  æ¸¸æˆæœåŠ¡å™¨    â”‚ è¡Œä¸ºè¿½è¸ª + ä½œå¼Šæ£€æµ‹              â”‚
â”‚  æ™ºèƒ½å®¶å±…      â”‚ è®¾å¤‡ç›‘æ§ + è‡ªåŠ¨åŒ–è¿½è¸ª            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**æœ€åæ›´æ–°**: 2025å¹´10æœˆ11æ—¥  
**ç»´æŠ¤è€…**: OTLPæ·±åº¦æ¢³ç†å›¢é˜Ÿ  
**ç‰ˆæœ¬**: 1.0.0

